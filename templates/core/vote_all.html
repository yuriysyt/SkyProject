{% extends 'core/base.html' %}
{% block content %}
<div class='row'>
    <div class='col-12'>
        <div class='card'>
            <div class='card-header'>
                <h2>Health Check Submission</h2>
                <p class='text-muted'>Session: {{ session.name }} ({{ session.date }})</p>
            </div>
            <div class='card-body'>
                <form method='post' action='{% url 'vote_all_submit' session.id %}'>
                    {% csrf_token %}
                    
                    <p class='mb-4'>Please provide your assessment for each item below:</p>
                    
                    {% for card in cards %}
                    <div class='card mb-4'>
                        <div class='card-header'>
                            <h5>{{ card.name }}</h5>
                        </div>
                        <div class='card-body'>
                            <div class='mb-3'>
                                <p>{{ card.description }}</p>
                            </div>
                            
                            <div class='mb-3'>
                                <label class='form-label'>Your Vote</label>
                                <div class='d-flex gap-3'>
                                    <div class='form-check'>
                                        <input class='form-check-input' type='radio' name='vote_{{ card.id }}' 
                                            value='green' id='vote_{{ card.id }}_green' 
                                            {% if existing_votes|get_item:card.id|get_item:'value' == 'green' %}checked{% endif %} required>
                                        <label class='form-check-label' for='vote_{{ card.id }}_green'>
                                            <span class='badge bg-success'>Green - Good</span>
                                        </label>
                                    </div>
                                    <div class='form-check'>
                                        <input class='form-check-input' type='radio' name='vote_{{ card.id }}' 
                                            value='amber' id='vote_{{ card.id }}_amber' 
                                            {% if existing_votes|get_item:card.id|get_item:'value' == 'amber' %}checked{% endif %}>
                                        <label class='form-check-label' for='vote_{{ card.id }}_amber'>
                                            <span class='badge bg-warning'>Amber - Concerning</span>
                                        </label>
                                    </div>
                                    <div class='form-check'>
                                        <input class='form-check-input' type='radio' name='vote_{{ card.id }}' 
                                            value='red' id='vote_{{ card.id }}_red' 
                                            {% if existing_votes|get_item:card.id|get_item:'value' == 'red' %}checked{% endif %}>
                                        <label class='form-check-label' for='vote_{{ card.id }}_red'>
                                            <span class='badge bg-danger'>Red - Bad</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class='mb-3'>
                                <label for='comment_{{ card.id }}' class='form-label'>Comment (Optional)</label>
                                <textarea class='form-control' id='comment_{{ card.id }}' name='comment_{{ card.id }}' rows='2'>{% if existing_votes|get_item:card.id %}{{ existing_votes|get_item:card.id|get_item:'comment' }}{% endif %}</textarea>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    
                    <div class='d-flex gap-2'>
                        <button type='submit' class='btn btn-primary'>Submit All Votes</button>
                        <a href='{% url 'dashboard' %}' class='btn btn-secondary'>Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
